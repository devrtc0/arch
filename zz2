#!/usr/bin/env sh

. ./env_cfg

sudo timedatectl set-ntp true

sh ./network_manager
sleep 2

if [ "$CFG_DE" -eq 1 ]; then
    cat ./lists/LST_BASE ./lists/LST_X ./lists/LST_DE | sudo pacman --needed --noconfirm -S -
else
    cat ./lists/LST_BASE | sudo pacman --needed --noconfirm -S -
fi
if [ -n "$CFG_DESKTOP_MANAGER" ]; then
    sudo systemctl enable "$CFG_DESKTOP_MANAGER.service"
fi
sudo systemctl enable fstrim.timer bluetooth.service

sh ./apps/yay

[ -n "$CFG_PACKAGES" ] && yay --sudoloop --needed --noconfirm -S $CFG_PACKAGES
[ -n "$CFG_SYSTEMD" ] && sudo systemctl enable $CFG_SYSTEMD
[ -n "$CFG_GROUPS" ] && sudo usermod -a -G ${CFG_GROUPS// /,} "$CFG_USERNAME"

sh ./sanctum.sanctorum
